"use strict";(self.webpackChunkguide_eoscostarica_io=self.webpackChunkguide_eoscostarica_io||[]).push([[8862],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return h}});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=o.createContext({}),c=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},p=function(e){var n=c(e.components);return o.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},u=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),u=c(t),h=a,_=u["".concat(l,".").concat(h)]||u[h]||d[h]||i;return t?o.createElement(_,s(s({ref:n},p),{},{components:t})):o.createElement(_,s({ref:n},p))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,s=new Array(i);s[0]=u;var r={};for(var l in n)hasOwnProperty.call(n,l)&&(r[l]=n[l]);r.originalType=e,r.mdxType="string"==typeof e?e:a,s[1]=r;for(var c=2;c<i;c++)s[c]=t[c];return o.createElement.apply(null,s)}return o.createElement.apply(null,t)}u.displayName="MDXCreateElement"},3720:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return d},default:function(){return h}});var o=t(7462),a=t(3366),i=(t(7294),t(3905)),s=t(4996),r=["components"],l={id:"private-network-installation",title:"EOSIO Private Network Installation",sidebar_label:"EOSIO Private Network Installation"},c=void 0,p={unversionedId:"tutorials/private-network-installation",id:"tutorials/private-network-installation",title:"EOSIO Private Network Installation",description:"Private Network Installation Tutorial",source:"@site/docs/tutorials/private-network-installation.md",sourceDirName:"tutorials",slug:"/tutorials/private-network-installation",permalink:"/docs/tutorials/private-network-installation",editUrl:"https://github.com/eoscostarica/guide.eoscostarica.io/tree/master/docs/tutorials/private-network-installation.md",tags:[],version:"current",lastUpdatedBy:"Paola Espinoza",lastUpdatedAt:1642095725,formattedLastUpdatedAt:"1/13/2022",frontMatter:{id:"private-network-installation",title:"EOSIO Private Network Installation",sidebar_label:"EOSIO Private Network Installation"},sidebar:"docs",previous:{title:"Node Installation",permalink:"/docs/tutorials/node-installation"},next:{title:"Hello World Contract",permalink:"/docs/tutorials/hello-world-contract"}},d=[{value:"Private Network Installation Tutorial",id:"private-network-installation-tutorial",children:[],level:2},{value:"Software Requirements",id:"software-requirements",children:[{value:"EOSIO Precompiled Binaries Installation",id:"eosio-precompiled-binaries-installation",children:[],level:3},{value:"EOSIO.CDT (Contract Development Toolkit) Binaries Installation",id:"eosiocdt-contract-development-toolkit-binaries-installation",children:[],level:3}],level:2},{value:"Genesis Node Configuration",id:"genesis-node-configuration",children:[],level:2},{value:"Start the nodeos Service",id:"start-the-nodeos-service",children:[],level:2},{value:"nodeos Service Registries",id:"nodeos-service-registries",children:[],level:2},{value:"<code>eosio.contracts</code> Configuration and Compilation",id:"eosiocontracts-configuration-and-compilation",children:[],level:2},{value:"<code>eosio.bios</code> Contract Deployment",id:"eosiobios-contract-deployment",children:[{value:"Activate <code>PREACTIVATE_FEATURE</code>",id:"activate-preactivate_feature",children:[],level:3},{value:"Deploy <strong>Old</strong> Contracts Version",id:"deploy-old-contracts-version",children:[],level:3},{value:"Deploy Latest Contracts Version",id:"deploy-latest-contracts-version",children:[],level:3}],level:2},{value:"Block Producer Nodes: Configuration and Execution",id:"block-producer-nodes-configuration-and-execution",children:[{value:"<code>config.ini</code>",id:"configini",children:[],level:3},{value:"<code>genesis.json</code>",id:"genesisjson",children:[],level:3},{value:"<code>start.sh</code>",id:"startsh",children:[],level:3}],level:2},{value:"Create Block Producer Accounts",id:"create-block-producer-accounts",children:[],level:2},{value:"Set Block Producers Schedule",id:"set-block-producers-schedule",children:[],level:2},{value:"API Node: Configuration and Execution",id:"api-node-configuration-and-execution",children:[{value:"<code>config.ini</code>",id:"configini-1",children:[],level:3},{value:"<code>genesis.json</code>",id:"genesisjson-1",children:[],level:3},{value:"<code>start.sh</code>",id:"startsh-1",children:[],level:3}],level:2},{value:"Seed Node: Configuration and Execution",id:"seed-node-configuration-and-execution",children:[{value:"<code>config.ini</code>",id:"configini-2",children:[],level:3},{value:"<code>genesis.json</code>",id:"genesisjson-2",children:[],level:3},{value:"<code>start.sh</code>",id:"startsh-2",children:[],level:3}],level:2},{value:"Stop the nodeos Service",id:"stop-the-nodeos-service",children:[],level:2},{value:"Reboot the nodeos Service",id:"reboot-the-nodeos-service",children:[],level:2},{value:"Reboot nodeos from Scratch",id:"reboot-nodeos-from-scratch",children:[],level:2},{value:"Interacting with the Network",id:"interacting-with-the-network",children:[{value:"Get Stored Data",id:"get-stored-data",children:[],level:3}],level:2}],u={toc:d};function h(e){var n=e.components,t=(0,a.Z)(e,r);return(0,i.kt)("wrapper",(0,o.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"private-network-installation-tutorial"},"Private Network Installation Tutorial"),(0,i.kt)("p",null,"Several topologies can be designed in the sense of quantity of nodes or redundancy of the data, nevertheless, for the practicity of this tutorial, the following topology is used as a main reference:"),(0,i.kt)("p",{style:{align:"center"}},(0,i.kt)("img",{src:(0,s.Z)("/img/private-network-installation-tutorial/initial-topology.png"),width:"100%"})),(0,i.kt)("h2",{id:"software-requirements"},"Software Requirements"),(0,i.kt)("p",null,"At the time of configuring a private EOSIO network there are some software installation requirements:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"EOSIO precompiled binaries installation"),(0,i.kt)("li",{parentName:"ol"},"EOSIO.CDT binaries installation")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Also, we are using Ubuntu 18.04 LTS, but if you want to use macOS or other supported OS, take a look at ",(0,i.kt)("a",{parentName:"em",href:"https://github.com/EOSIO/eos/releases"},"EOSIO releases"))),(0,i.kt)("h3",{id:"eosio-precompiled-binaries-installation"},"EOSIO Precompiled Binaries Installation"),(0,i.kt)("p",null,"Execute the following commands to install EOSIO precompiled binaries:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ wget https://github.com/eosio/eos/releases/download/v2.0.9/eosio_2.0.9-1-ubuntu-18.04_amd64.deb\n$ sudo apt install ./eosio_2.0.9-1-ubuntu-18.04_amd64.deb\n")),(0,i.kt)("p",null,"Once you installed EOSIO binaries; nodeos, a blockchain configuration from scratch and P2P networks interactions are among available functionalities that the protocol provides."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"To uninstall EOSIO execute: ",(0,i.kt)("inlineCode",{parentName:"p"},"$ sudo apt remove eosio"))),(0,i.kt)("h3",{id:"eosiocdt-contract-development-toolkit-binaries-installation"},"EOSIO.CDT (Contract Development Toolkit) Binaries Installation"),(0,i.kt)("p",null,"EOSIO.CDT is a toolkit that facilitates smart contract development in a EOSIO based blockchain networks. To install EOSIO.CDT v1.6.3 execute the following commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ wget https://github.com/eosio/eosio.cdt/releases/download/v1.6.3/eosio.cdt_1.6.3-1-ubuntu-18.04_amd64.deb\n$ sudo apt install ./eosio.cdt_1.6.3-1-ubuntu-18.04_amd64.deb\n")),(0,i.kt)("p",null,"You may want take a look at ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/EOSIO/eosio.cdt/releases"},"EOSIO.CDT releases"),"."),(0,i.kt)("h2",{id:"genesis-node-configuration"},"Genesis Node Configuration"),(0,i.kt)("p",null,"Before to configure the genesis node, it is necessary to create a directory called ",(0,i.kt)("inlineCode",{parentName:"p"},"~/biosboot/genesis"),", this is due to protocol particularities. So, for this execute the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ mkdir ~/biosboot\n$ mkdir ~/biosboot/genesis\n")),(0,i.kt)("p",null,"Now, create a file called ",(0,i.kt)("inlineCode",{parentName:"p"},"genesis.json")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"~/biosboot/")," directory, so for this execute the following command to create and edit the file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ nano ~/biosboot/genesis.json\n")),(0,i.kt)("p",null,"Copy and paste the following content in the previous created file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "initial_timestamp": "2018-12-05T08:55:11.000",\n  "initial_key": "EOS_PUB_DEV_KEY",\n  "initial_configuration": {\n    "max_block_net_usage": 1048576,\n    "target_block_net_usage_pct": 1000,\n    "max_transaction_net_usage": 524288,\n    "base_per_transaction_net_usage": 12,\n    "net_usage_leeway": 500,\n    "context_free_discount_net_usage_num": 20,\n    "context_free_discount_net_usage_den": 100,\n    "max_block_cpu_usage": 100000,\n    "target_block_cpu_usage_pct": 500,\n    "max_transaction_cpu_usage": 50000,\n    "min_transaction_cpu_usage": 100,\n    "max_transaction_lifetime": 3600,\n    "deferred_trx_expiration_window": 600,\n    "max_transaction_delay": 3888000,\n    "max_inline_action_size": 4096,\n    "max_inline_action_depth": 4,\n    "max_authority_depth": 6\n  },\n  "initial_chain_id": "0000000000000000000000000000000000000000000000000000000000000000"\n}\n')),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"This can be changed later on using privileged ",(0,i.kt)("inlineCode",{parentName:"p"},"set_param")," function. Read more ",(0,i.kt)("a",{parentName:"p",href:"https://guide.eoscostarica.io/docs/eos-learn/important-functions#set_params"},"here"),".")),(0,i.kt)("h2",{id:"start-the-nodeos-service"},"Start the nodeos Service"),(0,i.kt)("p",null,"Before to start the nodeos service, it is necessary to create the file ",(0,i.kt)("inlineCode",{parentName:"p"},"genesis_start.sh"),". For this, execute the following commands:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Create the file"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~/biosboot/genesis\n$ nano genesis_start.sh\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Paste the following content in the ",(0,i.kt)("inlineCode",{parentName:"p"},"genesis_start.sh")," file:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\nDATADIR="./blockchain"\n\nif [ ! -d $DATADIR ]; then  mkdir -p $DATADIR;\nfi\n\nnodeos \\\n  --genesis-json $DATADIR"/../../genesis.json" \\\n  --signature-provider EOS_PUB_DEV_KEY=KEY:EOS_PRIV_DEV_KEY \\\n  --plugin eosio::producer_plugin \\\n  --plugin eosio::producer_api_plugin \\\n  --plugin eosio::chain_plugin \\\n  --plugin eosio::chain_api_plugin \\\n  --plugin eosio::http_plugin \\\n  --plugin eosio::history_api_plugin \\\n  --plugin eosio::history_plugin \\\n  --data-dir $DATADIR"/data" \\\n  --blocks-dir $DATADIR"/blocks" \\\n  --config-dir $DATADIR"/config" \\\n  --producer-name eosio \\\n  --http-server-address localhost:8888 \\\n  --p2p-listen-endpoint localhost:9010 \\\n  --access-control-allow-origin=* \\\n  --contracts-console \\\n  --http-validate-host=false \\\n  --verbose-http-errors \\\n  --enable-stale-production \\\n  --p2p-peer-address GENESIS_NODE_IP:9011 \\\n  --p2p-peer-address GENESIS_NODE_IP:9012 \\\n  --p2p-peer-address GENESIS_NODE_IP:9013 \\\n>> $DATADIR"/nodeos.log" 2>&1 & \\\necho $! > $DATADIR"/eosd.pid"\n')),(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},"Remember to replace ",(0,i.kt)("inlineCode",{parentName:"p"},"EOS_PUB_DEV_KEY")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"EOS_PRIV_DEV_KEY")," with the previous generated key pair, also replace GENESIS_NODE_IP"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Finally, assign execution permission to the script:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"```bash\n$ cd ~/biosboot/genesis/\n$ chmod 755 genesis_start.sh\n$ ./genesis_start.sh\n```\n")),(0,i.kt)("p",{parentName:"li"},"Once the previous command were executed, the genesis node that will bring ",(0,i.kt)("strong",{parentName:"p"},"eosio")," as a name will be able to:")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Produce blocks")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Listen HTTP requests at ",(0,i.kt)("inlineCode",{parentName:"p"},"SPECIFIED_GENESIS_NODE_IP:8888"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Listen connection requests with other nodes at ",(0,i.kt)("inlineCode",{parentName:"p"},"SPECIFIED_GENESIS_NODE_IP:9010"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Print smart contracts output in the terminal"))),(0,i.kt)("h2",{id:"nodeos-service-registries"},"nodeos Service Registries"),(0,i.kt)("p",null,"You can inspect the nodeos service registries with the following commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~/biosboot/genesis/\n$ tail -f ./blockchain/nodeos.log\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"To exit log print mode, press CTRL+C.")),(0,i.kt)("h2",{id:"eosiocontracts-configuration-and-compilation"},(0,i.kt)("inlineCode",{parentName:"h2"},"eosio.contracts")," Configuration and Compilation"),(0,i.kt)("p",null,"It is necessary to install the latest version of ",(0,i.kt)("inlineCode",{parentName:"p"},"eosio.contracts")," along with ",(0,i.kt)("strong",{parentName:"p"},"v1.8.0")," version. To facilitate the understanding of the steps here described, the latest version will be referred as ",(0,i.kt)("inlineCode",{parentName:"p"},"EOSIO_CONTRACTS_DIRECTORY")," and the ",(0,i.kt)("inlineCode",{parentName:"p"},"v1.8.0")," as ",(0,i.kt)("inlineCode",{parentName:"p"},"EOSIO_OLD_CONTRACTS_DIRECTORY"),"."),(0,i.kt)("p",null,"The following installation steps must be followed in the order they appear."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Clone and compile the ",(0,i.kt)("inlineCode",{parentName:"li"},"eosio.contracts"),":",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ git clone https://github.com/EOSIO/eosio.contracts.git\n$ cd ./eosio.contracts/\n$ ./build.sh\n$ cd ./build/contracts/\n"))),(0,i.kt)("li",{parentName:"ol"},"Clone and install ",(0,i.kt)("inlineCode",{parentName:"li"},"eosio.cdt")," ",(0,i.kt)("inlineCode",{parentName:"li"},"v1.6.3")," (necessary version to compile ",(0,i.kt)("inlineCode",{parentName:"li"},"eosio.contracts")," ",(0,i.kt)("inlineCode",{parentName:"li"},"v1.8.0"),"):",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ wget https://github.com/eosio/eosio.cdt/releases/download/v1.6.3/eosio.cdt_1.6.3-1-ubuntu-18.04_amd64.deb\n$ sudo apt install ./eosio.cdt_1.6.3-1-ubuntu-18.04_amd64.deb\n"))),(0,i.kt)("li",{parentName:"ol"},"Clone and compile ",(0,i.kt)("inlineCode",{parentName:"li"},"eosio.contracts")," ",(0,i.kt)("inlineCode",{parentName:"li"},"v1.8.0"),":",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ git clone https://github.com/EOSIO/eosio.contracts.git eosio.contracts-1.8.x\n$ cd ./eosio.contracts-1.8.x/\n$ git checkout release/1.8.x\n$ ./build.sh\n$ cd ./build/contracts/\n")))),(0,i.kt)("h2",{id:"eosiobios-contract-deployment"},(0,i.kt)("inlineCode",{parentName:"h2"},"eosio.bios")," Contract Deployment"),(0,i.kt)("h3",{id:"activate-preactivate_feature"},"Activate ",(0,i.kt)("inlineCode",{parentName:"h3"},"PREACTIVATE_FEATURE")),(0,i.kt)("p",null,"Due to updates introduced in v1.8 and v2.0, it is necessary to activate a protocol feature called PREACTIVATE_FEATURE. To activate this feature, execute the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ curl --request POST \\\n    --url http://GENESIS_NODE_IP:8888/v1/producer/schedule_protocol_feature_activations \\\n    -d \'{"protocol_features_to_activate": ["0ec7e080177b2c02b278d5088611686b49d739925a92d9bfcacd7fc6b74053bd"]}\' \n')),(0,i.kt)("h3",{id:"deploy-old-contracts-version"},"Deploy ",(0,i.kt)("strong",{parentName:"h3"},"Old")," Contracts Version"),(0,i.kt)("p",null,"Now it is necessary to deploy the old version of the smart contracts (",(0,i.kt)("inlineCode",{parentName:"p"},"EOSIO_OLD_CONTRACTS_DIRECTORY"),"), for this it execute the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cleos set contract eosio EOSIO_OLD_CONTRACTS_DIRECTORY/eosio.bios/\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Expected output:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'Reading WAST/WASM from /users/documents/eos/build/contracts/eosio.bios/eosio.bios.wasm...\nUsing already assembled WASM...\nPublishing contract...\nexecuted transaction: 2150ed87e4564cd3fe98ccdea841dc9ff67351f9315b6384084e8572a35887cc  39968 bytes  4395 us\n#         eosio <= eosio::setcode               {"account":"eosio","vmtype":0,"vmversion":0,"code":"0061736d0100000001be023060027f7e0060067f7e7e7f7f...\n#         eosio <= eosio::setabi                {"account":"eosio","abi":{"types":[],"structs":[{"name":"buyrambytes","base":"","fields":[{"name":"p...\n')),(0,i.kt)("p",null,"Now that the old version of the contracts has been deployed, it is also necessary to activate special features that are recommended for networks based on the EOSIO protocol. To activate these features, execute the following commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# GET_SENDER\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"f0af56d2c5a48d60a4a5b5c903edfb7db3a736a94ed589d0b797df33ff9d3e1d\"]' -p eosio\n\n# FORWARD_SETCODE\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"2652f5f96006294109b3dd0bbde63693f55324af452b799ee137a81a905eed25\"]' -p eosio\n\n# ONLY_BILL_FIRST_AUTHORIZER\ncleos push action eosio activate '[\"8ba52fe7a3956c5cd3a656a3174b931d3bb2abb45578befc59f283ecd816a405\"]' -p eosio\n\n# RESTRICT_ACTION_TO_SELF\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"ad9e3d8f650687709fd68f4b90b41f7d825a365b02c23a636cef88ac2ac00c43\"]' -p eosio\n\n# DISALLOW_EMPTY_PRODUCER_SCHEDULE\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"68dcaa34c0517d19666e6b33add67351d8c5f69e999ca1e37931bc410a297428\"]' -p eosio\n\n # FIX_LINKAUTH_RESTRICTION\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"e0fb64b1085cc5538970158d05a009c24e276fb94e1a0bf6a528b48fbc4ff526\"]' -p eosio\n\n # REPLACE_DEFERRED\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"ef43112c6543b88db2283a2e077278c315ae2c84719a8b25f25cc88565fbea99\"]' -p eosio\n\n# NO_DUPLICATE_DEFERRED_ID\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"4a90c00d55454dc5b059055ca213579c6ea856967712a56017487886a4d4cc0f\"]' -p eosio\n\n# ONLY_LINK_TO_EXISTING_PERMISSION\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"1a99a59d87e06e09ec5b028a9cbb7749b4a5ad8819004365d02dc4379a8b7241\"]' -p eosio\n\n# RAM_RESTRICTIONS\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"4e7bf348da00a945489b2a681749eb56f5de00b900014e137ddae39f48f69d67\"]' -p eosio\n\n# WEBAUTHN_KEY\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"4fca8bd82bbd181e714e283f83e1b45d95ca5af40fb89ad3977b653c448f78c2\"]' -p eosio\n\n# WTMSIG_BLOCK_SIGNATURES\ncleos -u http://GENESIS_NODE_IP:8888 push action eosio activate '[\"299dcb6af692324b899b39f16d5a530a33062804e41f09dc97e9f156b4476707\"]' -p eosio\n")),(0,i.kt)("h3",{id:"deploy-latest-contracts-version"},"Deploy Latest Contracts Version"),(0,i.kt)("p",null,"Once the old version of the contracts has been deployed and the features have been activated, we proceed to deploy the recent version of the contracts:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cleos -u http://GENESIS_NODE_IP:8888 set contract eosio.bios EOSIO_CONTRACTS_DIRECTORY/eosio.bios/\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Expected output:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'Reading WAST/WASM from \xb7/users/documents/eos/contracts/eosio.bios/eosio.bios.wasm...\nUsing already assembled WASM...\nPublishing contract...\nexecuted transaction: 17fa4e06ed0b2f52cadae2cd61dee8fb3d89d3e46d5b133333816a04d23ba991  8024 bytes  974 us\n#         eosio <= eosio::setcode               {"account":"eosio.bios","vmtype":0,"vmversion":0,"code":"0061736d01000000017f1560037f7e7f0060057f7e...\n#         eosio <= eosio::setabi                {"account":"eosio.bios","abi":{"types":[],"structs":[{"name":"transfer","base":"","fields":[{"name"...\n')),(0,i.kt)("h2",{id:"block-producer-nodes-configuration-and-execution"},"Block Producer Nodes: Configuration and Execution"),(0,i.kt)("p",null,"We must create the configuration files for each block producer in each server. Since three block producers were conceived in the ",(0,i.kt)("a",{parentName:"p",href:"#private-network-installation-tutorial"},"topology"),", let's proceed to create their corresponding files. To do this, execute the following commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ mkdir producer1\n\n$ touch ~/producer1/config.ini\n$ touch ~/producer1/genesis.json\n$ touch ~/producer1/start.sh\n\n")),(0,i.kt)("p",null,"Once the files are created, copy the code snippet content to each corresponding file and repeat the process for each directory on each server (rename the directory according to the node):"),(0,i.kt)("h3",{id:"configini"},(0,i.kt)("inlineCode",{parentName:"h3"},"config.ini")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"agent-name = producer1 # CHANGE THIS ACCORDING TO THE NODE NAME\n\n# PLUGINS\nplugin = eosio::chain_plugin\nplugin = eosio::chain_api_plugin\nplugin = eosio::http_plugin\nplugin = eosio::producer_plugin\nplugin = eosio::producer_api_plugin\n# CHAIN \nchain-state-db-size-mb = 16384\nreversible-blocks-db-size-mb = 512\ncontracts-console = true\nabi-serializer-max-time-ms = 2000\nwasm-runtime = wabt\nenable-stale-production = false\npause-on-startup = false\nmax-irreversible-block-age = -1\ntxn-reference-block-lag = 0\n\n# BLOCK PRODUCER\nproducer-name = producer1 # CHANGE THIS ACCORDING TO THE NODE\n\n# PEERING NETWORK\np2p-server-address =  PRODUCER1_IP:9876     # CHANGE THIS ACCORDING TO THE NODE IP\np2p-listen-endpoint = 0.0.0.0:9876\np2p-max-nodes-per-host = 150\nmax-clients = 150\nconnection-cleanup-period = 30\nsync-fetch-span = 2000\nallowed-connection = any\n\np2p-peer-address = SEED_NODE_IP:SEED_NODE_PORT\np2p-peer-address = PRODUCER2_IP:PRODUCER2_PORT        # CHANGE THIS ACCORDING TO THE NODE\np2p-peer-address = PRODUCER3_IP:PRODUCER3_PORT        # CHANGE THIS ACCORDING TO THE NODE\np2p-peer-address = API_NODE_IP:API_NODE_PORT\n")),(0,i.kt)("h3",{id:"genesisjson"},(0,i.kt)("inlineCode",{parentName:"h3"},"genesis.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "initial_timestamp": "2018-12-05T08:55:11.000",\n  "initial_key": "EOS_PUB_DEV_KEY",\n  "initial_configuration": {\n    "max_block_net_usage": 1048576,\n    "target_block_net_usage_pct": 1000,\n    "max_transaction_net_usage": 524288,\n    "base_per_transaction_net_usage": 12,\n    "net_usage_leeway": 500,\n    "context_free_discount_net_usage_num": 20,\n    "context_free_discount_net_usage_den": 100,\n    "max_block_cpu_usage": 100000,\n    "target_block_cpu_usage_pct": 500,\n    "max_transaction_cpu_usage": 50000,\n    "min_transaction_cpu_usage": 100,\n    "max_transaction_lifetime": 3600,\n    "deferred_trx_expiration_window": 600,\n    "max_transaction_delay": 3888000,\n    "max_inline_action_size": 4096,\n    "max_inline_action_depth": 4,\n    "max_authority_depth": 6\n  },\n  "initial_chain_id": "0000000000000000000000000000000000000000000000000000000000000000"\n}\n')),(0,i.kt)("h3",{id:"startsh"},(0,i.kt)("inlineCode",{parentName:"h3"},"start.sh")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'#!/usr/bin/env bash\nDATA_DIR="blockchain"\nCONFIG_DIR="./blockchain/config"\nEOS_PUB_KEY=EOS_PUB_PRODUCER1_KEY  # CHANGE THIS ACCORDING TO THE NODE\nEOS_PRIV_KEY=EOS_PRIV_PRODUCER1_KEY  # CHANGE THIS ACCORDING TO THE NODE\necho "Starting VALIDATOR Node...";\nset -e;\nulimit -n 65535\nulimit -s 64000\nmkdir -p $CONFIG_DIR\ncp ./config.ini $CONFIG_DIR/config.ini\npid=0;\nnodeos=$"nodeos \\\n --config-dir $CONFIG_DIR \\\n --data-dir $DATA_DIR \\\n --blocks-dir $DATA_DIR/blocks \\\n --signature-provider $EOS_PUB_KEY=KEY:$EOS_PRIV_KEY" ;\nterm_handler() {\n if [ $pid -ne 0 ]; then\n   kill -SIGTERM "$pid";\n   wait "$pid";\n fi\n exit 0;\n}\nstart_nodeos() {\n $nodeos &\n sleep 10;\n if [ -z "$(pidof nodeos)" ]; then\n   $nodeos --hard-replay-blockchain &\n fi\n}\nstart_fresh_nodeos() {\n echo \'Starting new chain from genesis JSON\'\n $nodeos --delete-all-blocks --genesis-json genesis.json &\n}\ntrap \'echo "Shutdown of EOSIO service...";kill ${!}; term_handler\' 2 15;\nif [ ! -d $DATA_DIR/blocks ]; then\n start_fresh_nodeos &\nelif [ -d $DATA_DIR/blocks ]; then\n start_nodeos &\nfi\npid="$(pidof nodeos)"\nwhile true\ndo\n tail -f /dev/null & wait ${!}\ndone\n')),(0,i.kt)("p",null,"To run each node it is necessary to enter the directory, assign permissions and execute each ",(0,i.kt)("inlineCode",{parentName:"p"},"start.sh")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 start.sh # assign execution permission\n$ ./start.sh\n")),(0,i.kt)("h2",{id:"create-block-producer-accounts"},"Create Block Producer Accounts"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cleos -u http://GENESIS_NODE_IP:8888 create account eosio producer1 EOS_PUB_PRODUCER1_KEY\n$ cleos -u http://GENESIS_NODE_IP:8888 create account eosio producer2 EOS_PUB_PRODUCER2_KEY\n$ cleos -u http://GENESIS_NODE_IP:8888 create account eosio producer3 EOS_PUB_PRODUCER3_KEY\n")),(0,i.kt)("h2",{id:"set-block-producers-schedule"},"Set Block Producers Schedule"),(0,i.kt)("p",null,"Create the ",(0,i.kt)("inlineCode",{parentName:"p"},"producers.json")," file and paste the following content into it:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{"schedule":\n  [\n    {\n      "producer_name": "producer1", \n      "authority": [\n        "block_signing_authority_v0",\n        {\n          "threshold": 1,\n          "keys": [\n            {\n              "key":"EOS_PUB_PRODUCER1_KEY",\n              "weight":1\n            }\n          ]\n        }\n      ]\n    },\n    {\n      "producer_name":"producer2",\n      "authority": [\n        "block_signing_authority_v0",\n        {\n          "threshold":1,\n          "keys": [\n            {\n              "key":"EOS_PUB_PRODUCER2_KEY",\n              "weight":1\n            }\n          ]\n        }\n      ]\n    },\n    {\n      "producer_name":"producer3",\n      "authority": [\n        "block_signing_authority_v0",\n        {\n          "threshold":1,\n          "keys": [\n            {\n              "key":"EOS_PUB_PRODUCER3_KEY",\n              "weight":1\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n')),(0,i.kt)("p",null,"Now, execute the following command to set the schedule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ cleos -u http://GENESIS_NODE_IP:8888 push action eosio setprods "producers.json" -p eosio@active\n')),(0,i.kt)("h2",{id:"api-node-configuration-and-execution"},"API Node: Configuration and Execution"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ mkdir api-node\n$ cd api-node\n$ touch config.ini\n$ touch genesis.json\n$ touch start.sh\n")),(0,i.kt)("p",null,"Now copy the code snippet content to the appropriate file:"),(0,i.kt)("h3",{id:"configini-1"},(0,i.kt)("inlineCode",{parentName:"h3"},"config.ini")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"agent-name = api-node\n\n# PLUGINS\nplugin = eosio::chain_plugin\nplugin = eosio::chain_api_plugin\nplugin = eosio::http_plugin\nplugin = eosio::producer_plugin\nplugin = eosio::producer_api_plugin\n# HTTP\naccess-control-allow-origin = *\nhttp-validate-host = false\nverbose-http-errors = true\nhttp-server-address = 0.0.0.0:80\n\n# SSL\n#https-server-address = 0.0.0.0:443\n#https-certificate-chain-file = ./ssl/eosio.cr.crt\n#https-private-key-file = ./ssl/eosio.cr.priv.key\n\n# CHAIN \nchain-state-db-size-mb = 16384\nreversible-blocks-db-size-mb = 512\nabi-serializer-max-time-ms = 2000   \ncontracts-console = true\n\n# PEERING NETWORK\np2p-listen-endpoint = 0.0.0.0:9876\np2p-server-address =  API_NODE_IP:9876\np2p-max-nodes-per-host = 150\nmax-clients = 150\nsync-fetch-span = 2000\n\np2p-peer-address = PRODUCER1_IP:PRODUCER1_PORT\np2p-peer-address = PRODUCER2_IP:PRODUCER2_PORT\np2p-peer-address = PRODUCER3_IP:PRODUCER3_PORT\np2p-peer-address = SEED_NODE_IP:SEED_NODE_PORT\n")),(0,i.kt)("h3",{id:"genesisjson-1"},(0,i.kt)("inlineCode",{parentName:"h3"},"genesis.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n "initial_timestamp": "2018-12-05T08:55:11.000",\n "initial_key": "EOS_PUB_DEV_KEY",\n "initial_configuration": {\n   "max_block_net_usage": 1048576,\n   "target_block_net_usage_pct": 1000,\n   "max_transaction_net_usage": 524288,\n   "base_per_transaction_net_usage": 12,\n   "net_usage_leeway": 500,\n   "context_free_discount_net_usage_num": 20,\n   "context_free_discount_net_usage_den": 100,\n   "max_block_cpu_usage": 100000,\n   "target_block_cpu_usage_pct": 500,\n   "max_transaction_cpu_usage": 50000,\n   "min_transaction_cpu_usage": 100,\n   "max_transaction_lifetime": 3600,\n   "deferred_trx_expiration_window": 600,\n   "max_transaction_delay": 3888000,\n   "max_inline_action_size": 4096,\n   "max_inline_action_depth": 4,\n   "max_authority_depth": 6\n },\n "initial_chain_id": "0000000000000000000000000000000000000000000000000000000000000000"\n}\n')),(0,i.kt)("h3",{id:"startsh-1"},(0,i.kt)("inlineCode",{parentName:"h3"},"start.sh")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'#!/usr/bin/env bash\nDATA_DIR="blockchain"\nCONFIG_DIR="./blockchain/config"\necho "Starting API Node...";\nset -e;\nulimit -n 65535\nulimit -s 64000\nmkdir -p $CONFIG_DIR\ncp ./config.ini $CONFIG_DIR/config.ini\npid=0;\nnodeos=$"nodeos \\\n --config-dir $CONFIG_DIR \\\n --data-dir $DATA_DIR \\\n --blocks-dir $DATA_DIR/blocks" ;\nterm_handler() {\n if [ $pid -ne 0 ]; then\n   kill -SIGTERM "$pid";\n   wait "$pid";\n fi\n exit 0;\n}\nstart_nodeos() {\n $nodeos &\n sleep 10;\n if [ -z "$(pidof nodeos)" ]; then\n   $nodeos --hard-replay-blockchain &\n fi\n}\nstart_fresh_nodeos() {\n echo \'Starting new chain from genesis JSON\'\n $nodeos --delete-all-blocks --genesis-json genesis.json &\n}\ntrap \'echo "Shutdown of EOSIO service...";kill ${!}; term_handler\' 2 15;\nif [ ! -d $DATA_DIR/blocks ]; then\n start_fresh_nodeos &\nelif [ -d $DATA_DIR/blocks ]; then\n start_nodeos &\nfi\npid="$(pidof nodeos)"\nwhile true\ndo\n tail -f /dev/null & wait ${!}\ndone\n')),(0,i.kt)("p",null,"To start the node, assign execute permissions to ",(0,i.kt)("inlineCode",{parentName:"p"},"start.sh")," and run it:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 start.sh\n$ ./start.sh\n")),(0,i.kt)("h2",{id:"seed-node-configuration-and-execution"},"Seed Node: Configuration and Execution"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~\n$ mkdir seed\n$ touch config.ini\n$ touch genesis.json\n$ touch start.sh \n")),(0,i.kt)("p",null,"Now copy the code snippet content to the appropriate file:"),(0,i.kt)("h3",{id:"configini-2"},(0,i.kt)("inlineCode",{parentName:"h3"},"config.ini")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# EOSIO Testnet SEED NODE Config file\n# https://eoscostarica.io\n\nagent-name = seed\n\n# PLUGINS\nplugin = eosio::chain_plugin\n\n# CHAIN \nchain-state-db-size-mb = 16384\nreversible-blocks-db-size-mb = 512\ncontracts-console = true\nabi-serializer-max-time-ms = 2000\n\n# PEERING NETWORK\np2p-listen-endpoint = 0.0.0.0:9876\np2p-server-address = SEED_NODE_API:9876\n\np2p-peer-address = PRODUCER1_IP:PRODUCER1_PORT\np2p-peer-address = PRODUCER2_IP:PRODUCER2_PORT\np2p-peer-address = PRODUCER3_IP:PRODUCER3_PORT\np2p-peer-address = API_NODE_IP:API_NODE_PORT\n")),(0,i.kt)("h3",{id:"genesisjson-2"},(0,i.kt)("inlineCode",{parentName:"h3"},"genesis.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n "initial_timestamp": "2018-12-05T08:55:11.000",\n "initial_key": "EOS_PUB_DEV_KEY",\n "initial_configuration": {\n   "max_block_net_usage": 1048576,\n   "target_block_net_usage_pct": 1000,\n   "max_transaction_net_usage": 524288,\n   "base_per_transaction_net_usage": 12,\n   "net_usage_leeway": 500,\n   "context_free_discount_net_usage_num": 20,\n   "context_free_discount_net_usage_den": 100,\n   "max_block_cpu_usage": 100000,\n   "target_block_cpu_usage_pct": 500,\n   "max_transaction_cpu_usage": 50000,\n   "min_transaction_cpu_usage": 100,\n   "max_transaction_lifetime": 3600,\n   "deferred_trx_expiration_window": 600,\n   "max_transaction_delay": 3888000,\n   "max_inline_action_size": 4096,\n   "max_inline_action_depth": 4,\n   "max_authority_depth": 6\n },\n "initial_chain_id": "0000000000000000000000000000000000000000000000000000000000000000"\n}\n')),(0,i.kt)("h3",{id:"startsh-2"},(0,i.kt)("inlineCode",{parentName:"h3"},"start.sh")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'#!/usr/bin/env bash\necho "Starting SEED Node...";\nset -e;\nulimit -n 65535\nulimit -s 64000\n\nmkdir -p $CONFIG_DIR\ncp $WORK_DIR/config.ini $CONFIG_DIR/config.ini\n\npid=0;\n\nnodeos=$"nodeos \\\n  --config-dir $CONFIG_DIR \\\n  --data-dir $DATA_DIR \\\n  --blocks-dir $DATA_DIR/blocks" ;\n\nterm_handler() {\n  if [ $pid -ne 0 ]; then\n    kill -SIGTERM "$pid";\n    wait "$pid";\n  fi\n  exit 0;\n}\n\nstart_nodeos() {\n  $nodeos &\n  sleep 10;\n  if [ -z "$(pidof nodeos)" ]; then\n    $nodeos --hard-replay-blockchain &\n  fi\n}\n\nstart_fresh_nodeos() {\n  echo \'Starting new chain from genesis JSON\'\n  $nodeos --delete-all-blocks --genesis-json $WORK_DIR/genesis.json &\n}\n\ntrap \'echo "Shutdown of EOSIO service...";kill ${!}; term_handler\' 2 15;\n\nif [ ! -d $DATA_DIR/blocks ]; then\n  start_fresh_nodeos &\nelif [ -d $DATA_DIR/blocks ]; then\n  start_nodeos &\nfi\n\npid="$(pidof nodeos)"\n\nwhile true\ndo\n  tail -f /dev/null & wait ${!}\ndone\n')),(0,i.kt)("p",null,"To start the seed node, simply assign execution permissions to the ",(0,i.kt)("inlineCode",{parentName:"p"},"start.sh"),"\x1b file and execute it:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 start.sh\n$ ./start.sh\n")),(0,i.kt)("h2",{id:"stop-the-nodeos-service"},"Stop the nodeos Service"),(0,i.kt)("p",null,"Create the file ",(0,i.kt)("inlineCode",{parentName:"p"},"stop.sh")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"~/biosboot/genesis/")," directory and copy the following contents:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\nDATADIR="./blockchain/"\n\nif [ -f $DATADIR"/eosd.pid" ]; then\n    pid=`cat $DATADIR"/eosd.pid"`\n    echo $pid\n    kill $pid\n    rm -r $DATADIR"/eosd.pid"\n    echo -ne "Stopping Node"\n    while true; do\n        [ ! -d "/proc/$pid/fd" ] && break\n        echo -ne "."\n        sleep 1\n    done\n    echo -ne "\\rNode Stopped. \\n"\nfi\n')),(0,i.kt)("p",null,"Now you can execute ",(0,i.kt)("inlineCode",{parentName:"p"},"stop.sh")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 stop.sh \n$ ./stop.sh\n")),(0,i.kt)("h2",{id:"reboot-the-nodeos-service"},"Reboot the nodeos Service"),(0,i.kt)("p",null,"It is important to take into account that once the node is producing blocks it is not possible to restart the nodeos service using the same script created in the section ",(0,i.kt)("a",{parentName:"p",href:"#start-the-nodeos-service"},"Start the nodeos service"),", since the blockchain database already contains information from the initial execution. This is why it is recommended to create a new script with the name ",(0,i.kt)("inlineCode",{parentName:"p"},"start.sh"),". This file can continue to be used for future restarts of the node once the process is stopped."),(0,i.kt)("p",null,"Copy and paste the following content into the ",(0,i.kt)("inlineCode",{parentName:"p"},"start.sh")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\nDATADIR="./blockchain"\nEOS_PUB_KEY=EOS_PUB_KEY_HERE\nEOS_PRIV_KEY=EOS_PRIV_KEY_HERE\nif [ ! -d $DATADIR ]; then\n mkdir -p $DATADIR;\nfi\nnodeos \\\n--signature-provider EOS_PUB_KEY=KEY:EOS_PRIV_KEY \\\n--plugin eosio::producer_plugin \\\n--plugin eosio::producer_api_plugin \\\n--plugin eosio::chain_plugin \\\n--plugin eosio::chain_api_plugin \\\n--plugin eosio::http_plugin \\\n--plugin eosio::history_api_plugin \\\n--plugin eosio::history_plugin \\\n--data-dir "blockchain/data" \\\n--blocks-dir $DATADIR"/data/blockchain/blocks" \\\n--config-dir $DATADIR"/config" \\\n--producer-name eosio \\\n--http-server-address NODE_IP_HERE:8888 \\ # configurable\n--p2p-listen-endpoint NODE_IP_HERE:9010 \\ # configurable\n--access-control-allow-origin=* \\\n--contracts-console \\\n--http-validate-host=false \\\n--verbose-http-errors \\\n--enable-stale-production \\\n--p2p-peer-address PRODUCER1_IP:PRODUCER1_PORT \\\n--p2p-peer-address PRODUCER2_IP:PRODUCER2_PORT \\\n--p2p-peer-address PRODUCER3_IP:PRODUCER3_PORT \\\n>> $DATADIR"/nodeos.log" 2>&1 & \\\necho $! > $DATADIR"/eosd.pid"\n')),(0,i.kt)("p",null,"Now, assign execution permissions to the ",(0,i.kt)("inlineCode",{parentName:"p"},"start.sh")," file and execute it:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod 755 start.sh\n$ ./start.sh\n")),(0,i.kt)("p",null,"The following code fragment corresponds to the ",(0,i.kt)("inlineCode",{parentName:"p"},"hard_replay.sh")," script with the ",(0,i.kt)("inlineCode",{parentName:"p"},"--hard-replay-blockchain")," flag:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'DATADIR="./blockchain"\n\nif [ ! -d $DATADIR ]; then\n  mkdir -p $DATADIR;\nfi\n\nnodeos \\\n--signature-provider EOS_PUB_DEV_KEY=KEY:EOS_PRIV_DEV_KEY \\\n--plugin eosio::producer_plugin \\\n--plugin eosio::producer_api_plugin \\\n--plugin eosio::chain_plugin \\\n--plugin eosio::chain_api_plugin \\\n--plugin eosio::http_plugin \\\n--plugin eosio::history_api_plugin \\\n--plugin eosio::history_plugin \\\n--data-dir $DATADIR"/data" \\\n--blocks-dir $DATADIR"/blocks" \\\n--config-dir $DATADIR"/config" \\\n--producer-name eosio \\\n--http-server-address IP_NODE_HERE:8888 \\ # configurable\n--p2p-listen-endpoint IP_NODE_HERE:9010 \\ # configurable\n--access-control-allow-origin=* \\\n--contracts-console \\\n--http-validate-host=false \\\n--verbose-http-errors \\\n--enable-stale-production \\\n--p2p-peer-address IP_PRODUCER1:PRODUCER1_PORT \\\n--p2p-peer-address IP_PRODUCER2:PRODUCER2_PORT \\\n--p2p-peer-address IP_PRODUCER3:PRODUCER3_PORT \\\n--hard-replay-blockchain \\\n>> $DATADIR"/nodeos.log" 2>&1 & \\\necho $! > $DATADIR"/eosd.pid"\n')),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"\u201cperhaps we need to replay\u201d"),": this error may occur when restarting nodeos due to a missing ",(0,i.kt)("inlineCode",{parentName:"p"},"--hard-replay-blockchain")," flag (parameter that replays all transactions from the genesis node). To fix this error, run the ",(0,i.kt)("inlineCode",{parentName:"p"},"hard_replay.sh")," script.")),(0,i.kt)("h2",{id:"reboot-nodeos-from-scratch"},"Reboot nodeos from Scratch"),(0,i.kt)("p",null,"To restart the nodeos service from scratch, create the ",(0,i.kt)("inlineCode",{parentName:"p"},"clean.sh")," script, copy the following content and give it execution permissions (",(0,i.kt)("inlineCode",{parentName:"p"},"chmod 755 clean.sh"),"):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nrm -fr blockchain\nls -al\n")),(0,i.kt)("p",null,"If you want to delete the current configuration, blockchain data and log files, execute the following commands in the order they appear:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd ~/biosboot/genesis/\n$ ./stop.sh\n$ ./clean.sh\n$ ./genesis_start.sh\n")),(0,i.kt)("h2",{id:"interacting-with-the-network"},"Interacting with the Network"),(0,i.kt)("p",null,"At this point, the network is able to host any contract. Let's suppose you want to deploy a contract like ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/eoscostarica/eoscr-smart-contracts/tree/master/easycontract"},"easycontract")," EOS Costa Rica's example repo. After you follow the specified instructions there, you can call easycontract's ",(0,i.kt)("inlineCode",{parentName:"p"},"save")," ACTION like following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'cleos -u NODE_URL_HERE push action easycontract save \'{"date":"2021/01/10 21:01:35","filename":"ejemplo.pdf","path":"/var/www/docs"}\' -p easycontract@active\n')),(0,i.kt)("p",null,"After the execution, you will get an output in the terminal."),(0,i.kt)("h3",{id:"get-stored-data"},"Get Stored Data"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cleos -u NODE_URL_HERE get transaction TRANSACTION_ID_HERE\n")))}h.isMDXComponent=!0}}]);